{"version":3,"sources":["webpack:///./src/pages/discDetail.vue","webpack:///./src/pages/discDetail.vue?8bfc","webpack:///./src/pages/discDetail.vue?5b98","webpack:///./src/api/recommend.js"],"names":["transform","prefixStyle","playMusicMixin","musicTitle","playAll","musicList","scroll","methods","onScroll","pos","this","scrollY","y","mapMutations","setSongList","beforeEnter","_this","discid","$route","params","id","Number","getSongList","then","res","data","songs","catch","err","console","log","singer","split","mid","searchSong","img","query","title","logo","refreshScroll","$refs","BScroll","refresh","computed","mapGetters","pages_discDetail","mixins","Object","components","created","mounted","imageHeight","bgImg","clientHeight","minTransalteY","watch","newVal","scale","offsetHeight","toFixed","style","translateY","Math","max","layer","zIndex","height","RESERVED_HEIGHT","display","isMiniPlayShow","_this2","$nextTick","selectortype_template_index_0_src_pages_discDetail","render","_vm","_h","$createElement","_c","_self","attrs","name","staticClass","_v","ref","src","gold","class","probeType","listenScroll","on","_l","l","i","key","click","$event","playMusic","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_assign___default","commonParams","platform","uin","needNewCode","jsonp","options","categoryId","sortId","limit","getData"],"mappings":"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","file":"static/js/3.b042f1343b8aa4a6e885.js","sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { getSongList } from '../api/recommend.js'\r\nimport { searchSong } from '../api/song.js'\r\nimport musicTitle from '../components/musicTitle/musicTitle'\r\nimport playAll from '../components/play-all/play-all.vue'\r\nimport musicList from '../components/musicList/musicList'\r\nimport scroll from '../components/scroll/scroll.vue'\r\nimport { prefixStyle } from '../common/js/utils.js'\r\nimport { mapMutations, mapGetters } from 'vuex'\r\nimport {playMusicMixin} from '../common/js/mixins.js'\r\nconst transform = prefixStyle('transform')\r\nconst RESERVED_HEIGHT = 40\r\nexport default {\r\n  mixins: [playMusicMixin],\r\n  data() {\r\n    return {\r\n      data: '',\r\n      songs: [],\r\n      scroll: Object,\r\n      scrollY: 0\r\n    }\r\n  },\r\n\r\n  components: {\r\n    musicTitle,\r\n    playAll,\r\n    musicList,\r\n    scroll\r\n  },\r\n\r\n  methods: {\r\n    onScroll: function(pos) {\r\n      this.scrollY = pos.y\r\n    },\r\n    ...mapMutations({\r\n      setSongList: 'SET_SONG_LIST'\r\n    }),\r\n    beforeEnter() {\r\n      let discid = this.$route.params.id\r\n      // 歌单传来的id是数字\r\n      if (Number(discid)) {\r\n        getSongList(discid)\r\n          .then(res => {\r\n            this.data = res.data\r\n            this.songs = res.data.songs\r\n            this.setSongList(res.data.songs)\r\n          })\r\n          .catch(err => {\r\n            console.log('getSongList:', err)\r\n          })\r\n      } else {\r\n        // 传来歌手名就搜索歌手并且显示\r\n        let singer = discid.split('-')[0]\r\n        let mid = discid.split('-')[1]\r\n        searchSong(singer).then(res => {\r\n          let img = `https://y.gtimg.cn/music/photo_new/T001R300x300M000${mid}.jpg?max_age=2592000`\r\n          this.log(this.$route.query)\r\n          this.data = {title: singer, logo: img}\r\n          this.songs = res.data\r\n          this.setSongList(res.data)\r\n        }).catch(err => {\r\n          this.log('discDetail/searchSong:', err)\r\n        })\r\n      }\r\n    },\r\n    refreshScroll() {\r\n      this.$refs.BScroll.refresh()\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    ...mapGetters([\r\n      'isMiniPlayShow'\r\n    ])\r\n  },\r\n  created() {\r\n    // 用于通过链接分享歌单\r\n    this.beforeEnter()\r\n  },\r\n  mounted() {\r\n    this.imageHeight = this.$refs.bgImg.clientHeight\r\n    this.minTransalteY = -(this.imageHeight - RESERVED_HEIGHT)\r\n    // this.$refs.BScroll.style.top = `${this.imageHeight}px`\r\n    // let self = this\r\n    // TODO:todo:srcoll组件已封装好,现在可以将下面代码改为插件\r\n    // this.$nextTick(() => {\r\n    //   setTimeout(() => {\r\n    //     /* eslint-disable no-new */\r\n    //     self.scroll = new BScroll(this.$refs.BScroll, {\r\n    //       probeType: 3,\r\n    //       bounce: {\r\n    //         top: true,\r\n    //         bottom: true\r\n    //       }\r\n    //     })\r\n    //     self.scroll.on('scroll', this.onScroll)\r\n    //   }, 10)\r\n    // })\r\n  },\r\n  watch: {\r\n    scrollY(newVal) {\r\n      // 向下滚动时scrollY>0,\r\n      if (this.scrollY > 0) {\r\n        // 计算出一个背景图片的放大率,算法:用滚动的大小除以图片整个的高度表示\r\n        let scale =\r\n          (this.scrollY / this.$refs.bgImg.offsetHeight).toFixed(2) * 1 + 1\r\n        this.$refs.bgImg.style[transform] = `scale(${scale})`\r\n      }\r\n      // TODO:learn:如果使用下面这种值判断的方法会导致判断不准确,比如要 a>5这种条件,希望a=6时立即生效,\r\n      // 但是实际过程中有可能会达到a=7甚至a=17,导致结果不准确,出bug\r\n      // 但是使用Math.max()这种方法就很准确\r\n      // if (newVal > this.minTransalteY) {\r\n\r\n      // }\r\n\r\n      // 控制遮罩层平移的最大高度\r\n      let translateY = Math.max(this.minTransalteY, newVal)\r\n      this.$refs.layer.style[transform] = `translate3d(0,${translateY}px,0)`\r\n      // 当遮罩不再运动时,让背景图盖住多出的scroll内容,并且隐藏playAll按钮,将背景图大小调整为40高度\r\n      if (translateY === this.minTransalteY) {\r\n        this.$refs.bgImg.style.zIndex = 2\r\n        this.$refs.bgImg.style.height = RESERVED_HEIGHT + 'px'\r\n        this.$refs.playAll.style.display = 'none'\r\n      } else {\r\n        this.$refs.bgImg.style.zIndex = 0\r\n        this.$refs.bgImg.style.height = '40%'\r\n        this.$refs.playAll.style.display = ''\r\n      }\r\n    },\r\n    isMiniPlayShow() {\r\n      if (this.isMiniPlayShow) {\r\n        this.$nextTick(() => {\r\n          this.$refs.BScroll.refresh()\r\n        })\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/discDetail.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"name\":\"left-slide\"}},[_c('div',{staticClass:\"disc-detail-wrap\"},[_c('div',{staticClass:\"disc-detail\"},[_c('div',{staticClass:\"header\"},[_c('music-title',{attrs:{\"title\":_vm.data.title}})],1),_vm._v(\" \"),_c('div',{ref:\"bgImg\",staticClass:\"bg-img\"},[_c('div',{staticClass:\"mask\"}),_vm._v(\" \"),_c('img',{attrs:{\"src\":_vm.data.logo}}),_vm._v(\" \"),_c('div',{ref:\"playAll\",staticClass:\"play-all-wrap\"},[_c('play-all',{attrs:{\"gold\":true}})],1)]),_vm._v(\" \"),_c('div',{ref:\"layer\",staticClass:\"bg-layer\"}),_vm._v(\" \"),_c('scroll',{ref:\"BScroll\",staticClass:\"song-list-wrap\",class:_vm.isMiniPlayShow?'showMiniPlayer':'',attrs:{\"probeType\":3,\"listenScroll\":true},on:{\"scroll\":_vm.onScroll}},[_c('div',{staticClass:\"song-list\"},_vm._l((_vm.songs),function(l,i){return _c('div',{key:i,staticClass:\"song-list-item\",on:{\"click\":function($event){_vm.playMusic(l,i)}}},[_c('music-list',{attrs:{\"singer\":l.singer,\"name\":l.name}})],1)}))])],1)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-07507a73\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/discDetail.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-07507a73\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/vux-loader/src/style-loader.js!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./discDetail.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vue-loader/lib/selector?type=script&index=0!./discDetail.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vue-loader/lib/selector?type=script&index=0!./discDetail.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-07507a73\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../node_modules/vux-loader/src/template-loader.js!../../node_modules/vue-loader/lib/selector?type=template&index=0!./discDetail.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-07507a73\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/discDetail.vue\n// module id = null\n// module chunks = ","import jsonp from 'common/js/jsonp'\r\nimport { commonParams, options, key } from './config'\r\n// import axios from 'axios'\r\nimport {getData} from '../common/js/utils'\r\nexport function getRecommend() {\r\n  const url = 'https://c.y.qq.com/musichall/fcgi-bin/fcg_yqqhomepagerecommend.fcg'\r\n\r\n  const data = Object.assign({}, commonParams, {\r\n    platform: 'h5',\r\n    uin: 0,\r\n    needNewCode: 1\r\n  })\r\n\r\n  return jsonp(url, data, options)\r\n}\r\n\r\n// 热歌列表  流派/最热\r\nexport function getDiscList() {\r\n  const url = 'https://api.bzqll.com/music/tencent/hotSongList'\r\n  const data = {\r\n    key,\r\n    categoryId: '6',\r\n    sortId: '3',\r\n    limit: '60'\r\n  }\r\n  return getData(url, data)\r\n}\r\n\r\n// 歌曲列表(热歌的内容)\r\nexport function getSongList(id) {\r\n  const url = 'https://api.bzqll.com/music/tencent/songList'\r\n  const data = { key, id }\r\n  return getData(url, data)\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/recommend.js"],"sourceRoot":""}